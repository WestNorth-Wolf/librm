# 阈值触发

## 简介

本例程演示如何用 `ThresholdTrigger` 类在某个变量高于或低于某个阈值时触发一次回调函数。

对于一个变量 `var`，将变量作为第一个参数传入，对于非布尔类型，还需要传入一对阈值作为第二和第三个参数。`ThresholdTrigger` 类监视变量的变化，并在达到阈值时触发回调函数。

对于自定义类型，只要实现了 `<` 和 `>` 比较运算符，就可以使用 `ThresholdTrigger`。

用 `OnRising` 和 `OnFalling` 方法注册上升沿和下降沿的回调函数。

## 代码

```c++
#include <librm.hpp>

#include <iostream>

int main() {
  bool var;
  auto tt = rm::modules::algorithm::ThresholdTrigger<bool>(var)
                .OnRising([]() { std::cout << "Rising edge\n"; })
                .OnFalling([]() { std::cout << "Falling edge\n"; });

  for (;;) {
    tt.Update();
  }
}
```

```c++
#include <librm.hpp>

#include <iostream>

int main() {
  int var;
  auto tt = rm::modules::algorithm::ThresholdTrigger<int>(var, 10, 20)
                .OnRising([]() { std::cout << "Rising edge\n"; })
                .OnFalling([]() { std::cout << "Falling edge\n"; });

  for (;;) {
    tt.Update();
  }
}
```
